# Cookies

# Description

Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:64944/

# Hints

none

# Analyse

Click vào đường link ta được hình ảnh sau đây 

![image](https://user-images.githubusercontent.com/115911041/221119074-2af333be-7410-478e-8709-f37558a8e4cc.png)

Vì tựa đề của challenge lần này là [cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies) nên ta sẽ phải làm việc cookies để cho ra flag.

# Solution 1

Sử dụng [cookies editor google extension](https://chrome.google.com/webstore/detail/cookie-editor/hlkenndednhfkekhgcdicdfddnkalmdm) 

Ban đầu value = -1. Mình thử nhập `snickerdoodle` ở box thì value = 0 và hiện ra như sau

![image](https://user-images.githubusercontent.com/115911041/221120091-547114b2-901a-4eec-8657-fa0496c80303.png)

Sau đó mình trở về hompage thì value trở về -1

Từ đó mình thử các giá trị, các giá trị khác nhau cho ra các loại tên cookies khác nhau, cho đến khi value=18 thì cho ra flag

![image](https://user-images.githubusercontent.com/115911041/221120386-afa5e127-750a-4510-b562-5804adb791d9.png)

Flag

`picoCTF{3v3ry1_l0v3s_c00k135_cc9110ba}`

# Solution 2

Tương tự như cách ở trên nhưng ta không dùng extension mà sử dụng crt+shift+I ở trang web và sửa value=18. Sau đó refresh page sẽ cho ra flag.

# Solution 3

Cách này sẽ tương tự như 2 cách trên cũng chạy value nhưng ta dùng tool nên sẽ nhanh hơn

Sử dụng [Burp Intruder](https://portswigger.net/burp/documentation/desktop/tools/intruder) của Burp Suite 

Intercept on ở phần Proxy sau đó open browser rồi gắn link `http://mercury.picoctf.net:64944` sau đó tắt intercept 

Ở cửa số HTTP History hiện ra các lịch sử HTTP, chọn phần có title là cookies rồi ctrl+I để gửi sang `Intruder`

Chọn phần payloads, rồi modify như sau

![image](https://user-images.githubusercontent.com/115911041/221128186-899c190c-a1cc-4422-8e67-429bf1a56645.png)

Ta sẽ cho chạy giá trị từ -1 đến 30. Cách này tương tự như 2 cách trên nhưng mà nó nhanh hơn 

Nhấn `Start attack` 

![image](https://user-images.githubusercontent.com/115911041/221129230-eb12c638-29a3-4d8a-ba9e-47ac5d3f84b2.png)

Để tìm Flag nhanh hơn ta vào settings rồi modify như dưới đây

![image](https://user-images.githubusercontent.com/115911041/221129401-9d23066c-5093-4d4b-b617-87aa6722d3f5.png)

Ta có thể thấy sẽ có 1 dòng PicoCCTF xuất hiện 2 lần khác so với những dòng khác là 1 lần 

![image](https://user-images.githubusercontent.com/115911041/221129886-fad87be7-a060-4c8d-9619-70b7dbbde3c9.png)

Nhấp vào đó, chọn phần Response, kéo xuống ta sẽ tìm được flag

![image](https://user-images.githubusercontent.com/115911041/221130084-e8361394-6354-4aad-8ef3-1f4108f37adf.png)

Flag

`picoCTF{3v3ry1_l0v3s_c00k135_cc9110ba}`

